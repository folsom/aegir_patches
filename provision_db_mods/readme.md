Overview
========

File patched :  mysql.php
Dependencies :  provision_mods/provision.api.php.patch
Aegir version:  3.12.1
Last Updated :  10/17/17

This patch omits the gtid from mysql dumps generated by centrally managed IS Aegir databases. 
The gtid is known to produce errors during clone tasks so it must be omitted. 

The original Aegir core file is in ./original.

Changes:

UPDATE 03/09/17 -
Version checking was added to the mysqldump command.  If the version isn't 5.6 or greater, the
GTID option wasn't available and shouldn't be used.

UPDATE 04/20/17 -
The mysqldump command was not using any settings from the /etc/my.cnf configuration file, via the
--defaults-file switch.  This has been changed to --extra-defaults-file, which first reads
in the my.cnf file before adding settings from the specified one.

UPDATE 07/28/17 -
Modfied the GTID patch so that, rather than check the version, it checks a Drush variable that
can be set to TRUE to suppress the restoration of GTIDs.  The variable is 
'provision_mysqldump_suppress_gtid_restore'.

The new option is noted in a new comment patched into the 'provision.api.php' file by the
'provision.api.php.patch' patch.  It isn't an operational change so only affects this
module by documenting the addition of the option.

10/17/17 -
The GTID patch is now included in 3.12.1.  So this patch now only makes the change to the
--defaults-file switch...changing it to --defaults-extra-file.

Application
===========

cd /var/aegir/.drush/provision/db/Provision/Service/db/
$ patch < /var/aegir/aegir_patches/provision_db_mods/mysql.php.patch
